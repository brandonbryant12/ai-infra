model_list:
{% for model in models %}
- model_name: {{ model.name }}
  litellm_params:
    model: openrouter/{{ model.id }}
    api_key: os.environ/OPENROUTER_API_KEY
    api_base: https://openrouter.ai/api/v1
{% if model.context_length %}
    max_tokens: {{ model.max_completion_tokens or (model.context_length // 4) }}
{% endif %}
{% endfor %}

general_settings:
  # Parse user info from OpenWebUI headers - using email for better tracking
  user_header_name: X-OpenWebUI-User-Email
  
  # Master key for admin access
  master_key: os.environ/LITELLM_MASTER_KEY
  
  # Enable health checks
  health_check_interval: 300
  
  # Enable detailed debugging
  detailed_debug: true

litellm_settings:
  # Drop unsupported parameters
  drop_params: true
  
  # Basic logging
  set_verbose: true
  
  # Request timeout
  request_timeout: {{ request_timeout | default(600) }}
  
  # Custom Langfuse callbacks for enhanced OpenWebUI tracking
  success_callback: ["custom_langfuse_callback.CustomLangfuseLogger"]
  failure_callback: ["custom_langfuse_callback.CustomLangfuseLogger"]
  
  # Enable custom callbacks
  custom_callback_class: "custom_langfuse_callback.CustomLangfuseLogger"
  
  # Enable caching if specified
{% if enable_caching %}
  cache: true
  cache_type: redis
  redis_host: {{ redis_host | default('localhost') }}
  redis_port: {{ redis_port | default(6379) }}
{% endif %}

# Optional router settings
{% if enable_fallbacks %}
router_settings:
  routing_strategy: simple-shuffle
  model_group_alias:
{% for group in model_groups %}
    {{ group.alias }}: {{ group.models | join(', ') }}
{% endfor %}
{% endif %}